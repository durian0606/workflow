# AI 담당자 추천 기능 설정 가이드

## 🤖 기능 소개

작업 추가 시 Google Gemini AI가 과거 작업 히스토리를 분석하여 최적의 담당자를 자동으로 추천합니다.

### 추천 기준
- ✅ 해당 현장에서의 작업 경험 (현장 친숙도)
- ✅ 해당 작업 유형의 수행 경험 (작업 전문성)
- ✅ 현재 진행 중인 작업 부하 (업무 균형)
- ✅ 작업 완료율 (신뢰도)

---

## 📋 설정 방법

### 1️⃣ Google Gemini API 키 발급

1. https://aistudio.google.com/apikey 접속
2. "Get API Key" 또는 "Create API Key" 클릭
3. API 키 복사

**무료 할당량**: 분당 15개 요청, 일일 1500개 요청

---

### 2️⃣ API 키 설정 (2가지 방법)

#### 방법 1: config.js 직접 수정 (간단)

`config.js` 파일 33번째 줄 수정:

```javascript
gemini: {
  apiKey: 'YOUR_GEMINI_API_KEY_HERE',  // ← 여기에 발급받은 API 키 붙여넣기
```

⚠️ **주의**: 이 방법은 공개 저장소에서는 비추천 (API 키 노출 위험)

---

#### 방법 2: config.local.js 사용 (권장) ✅

프로젝트 루트에 `config.local.js` 파일 생성:

```javascript
// config.local.js
if (typeof window !== 'undefined' && window.CONFIG) {
  window.CONFIG.gemini.apiKey = '여기에_발급받은_API_키_붙여넣기';
  console.log('✅ config.local.js 로드: Gemini API 키 설정됨');
}
```

📌 **config.local.js는 .gitignore에 포함되어 Git에 커밋되지 않습니다**

---

## 🎯 사용 방법

### 1. 작업 추가
- 현장명과 작업 내용 입력 후 "추가" 버튼 클릭
- 작업이 즉시 추가되고, 백그라운드에서 AI 분석 시작

### 2. AI 추천 확인
- 몇 초 후 작업 카드에 **"🤖 AI 추천"** 배지 표시
- 담당자 드롭다운을 열면 추천 담당자에 **⭐** 아이콘과 신뢰도 표시
- 카드 하단에 **추천 이유**가 파란색 박스로 표시

### 3. 시험 작업 특별 처리
- "시험" 작업 추가 시 자동으로 4개의 관련 작업 생성:
  - 캡핑 (1 영업일 후)
  - 탈형 (2 영업일 후)
  - 7일 강도 시험
  - 28일 강도 시험
- 각 작업마다 **개별 AI 추천** 제공

---

## 🔧 테스트 방법

```
1. 브라우저에서 앱 새로고침 (F5)
2. 팀에 담당자가 2명 이상 있는지 확인
3. 새 작업 추가 (예: 현장 "A 현장", 작업 "타설")
4. 개발자 콘솔(F12) 확인:
   - "🤖 AI 담당자 추천 시작"
   - "✅ Gemini API 응답"
   - "✅ AI 추천 완료"
5. 작업 카드에 AI 추천 배지 확인
```

---

## 💡 동작 원리

### 처음 작업 추가 시
- 히스토리가 없어 **작업 부하가 적은 담당자** 추천

### 기존 작업이 많을 때
- 현장 경험, 작업 유형 전문성, 현재 부하를 **종합적으로 고려**

### 담당자가 1명뿐일 때
- API 호출 없이 바로 해당 담당자 추천 (비용 절약)

---

## ⚙️ 기능 비활성화

AI 추천 기능을 사용하지 않으려면 `config.js` 수정:

```javascript
app: {
  features: {
    aiAssigneeRecommendation: false  // true → false
  }
}
```

---

## 🐛 문제 해결

### "AI 추천 기능을 사용하려면 API 키를 설정해주세요" 메시지
→ config.js 또는 config.local.js에 API 키 확인

### AI 추천이 표시되지 않음
1. 콘솔(F12)에서 에러 확인
2. API 키가 올바른지 확인
3. 담당자가 2명 이상인지 확인
4. 네트워크 연결 확인

### API 할당량 초과
- 무료 티어: 분당 15개, 일일 1500개 요청
- 제한 초과 시 다음 날까지 대기 또는 유료 플랜 고려

---

## 📞 문의

AI 추천 기능 관련 문의: GitHub Issues
